"use strict";angular.module("imageEditorApp",[]),angular.module("imageEditorApp").controller("MainCtrl",["$scope",function(a){a.setImageFile=function(b){a.init();var c=new FileReader,d=b.files[0];c.onload=function(b){a.image.src=b.target.result,console.log(a.image.src)},c.readAsDataURL(d)},a.init=function(){a.brightness=0,a.contrast=1,a.strength=100,a.colors={red:0,green:0,blue:0},a.autocontrast=!1,a.vignette=!1,a.canvas=angular.element("#myCanvas")[0],a.ctx=a.canvas.getContext("2d"),a.image=new Image,a.image.onload=a.resetImage},a.init(),a.resetImage=function(){a.canvas.width=a.image.width,a.canvas.height=a.image.height,a.ctx.drawImage(a.image,0,0),a.imageData=a.ctx.getImageData(0,0,a.image.width,a.image.height),a.dataArray=a.imageData.data},a.applyFilters=function(){a.resetImage(),a.changeBrightness(),a.changeContrast(),a.tint(),a.autocontrast&&a.autoContrast(),a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height),a.ctx.putImageData(a.imageData,0,0)},a.changeBrightness=function(){for(var b=0;b<a.dataArray.length;b+=4)a.dataArray[b]+=parseFloat(a.brightness),a.dataArray[b+1]+=parseFloat(a.brightness),a.dataArray[b+2]+=parseFloat(a.brightness)},a.changeContrast=function(){for(var b=259*(parseFloat(a.contrast)+255)/(255*(259-parseFloat(a.contrast))),c=0;c<a.dataArray.length;c+=4)a.dataArray[c]=b*(a.dataArray[c]-128)+128,a.dataArray[c+1]=b*(a.dataArray[c+1]-128)+128,a.dataArray[c+2]=b*(a.dataArray[c+2]-128)+128},a.tint=function(){for(var b=0;b<a.dataArray.length;b+=4)a.dataArray[b]=parseFloat(a.colors.red)*parseFloat(a.strength)/100+a.dataArray[b],a.dataArray[b+1]=parseFloat(a.colors.green)*parseFloat(a.strength)/100+a.dataArray[b+1],a.dataArray[b+2]=parseFloat(a.colors.blue)*parseFloat(a.strength)/100+a.dataArray[b+2]};var b=0,c=0,d=0,e=0,f=0,g=0,h=[],i=[],j=[];a.autoContrast=function(){for(var k=a.imageData.data,l=0;l<k.length;l+=4)k[l]>=e?e=k[l]:k[l]<=b&&(b=k[l]),k[l+1]>=f?f=k[l+1]:k[l+1]<=c&&(c=k[l+1]),k[l+2]>=g?g=k[l+2]:k[l+2]<=d&&(d=k[l+2]),h.push(k[l]),i.push(k[l+1]),j.push(k[l+2]);for(console.log(b+" "+e+" "+c+" "+f+" "+d+" "+g),l=0;l<k.length;l+=4)k[l]=k[l]*((k[l]-b)/(e-b)),k[l+1]=k[l+1]*((k[l+1]-c)/(f-c)),k[l+2]=k[l+2]*((k[l+2]-d)/(g-d));a.printHistogram()},a.printHistogram=function(){var a=$("#histogramCanvas")[0].getContext("2d"),b=function(b,c,d,e){a.fillStyle=d,$.each(c,function(d,f){var g=c[d]/b*100;a.fillRect(d,e,1,-Math.round(g))})};b(e,h,"rgb(255,0,0)",100),b(f,i,"rgb(0,255,0)",200),b(g,j,"rgb(0,0,255)",300)},a.saveImage=function(){var b=a.canvas.toDataURL("image/png");a.url=b}}]).config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|coui|data):/)}]),angular.module("imageEditorApp").run(["$templateCache",function(a){a.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.c582c4d1.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div>')}]);